<!DOCTYPE html>
<html>
  <head>
    <title>Reset Password</title>
  </head>
  <body>
    <h2>Reset Password</h2>
    <form id="resetPasswordForm">
      <input type="hidden" name="requestId" value="{{requestId}}" />
      <label for="newPassword">New Password:</label>
      <input
        type="password"
        id="newPassword"
        name="newPassword"
        required
      /><br />
      <label for="confirmPassword">Confirm Password:</label>
      <input
        type="password"
        id="confirmPassword"
        name="confirmPassword"
        required
      /><br />
      <input type="submit" value="Submit" />
    </form>
    <script>
      document
        .getElementById("resetPasswordForm")
        .addEventListener("submit", async (event) => {
          console.log("hello")
          event.preventDefault();
          const formData = new FormData(event.target);
          const requestData = {};
          formData.forEach((value, key) => {
            requestData[key] = value;
          });

          try {
            const response = await fetch("/user/updatepassword", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify(requestData),
            });
            const data = await response.json();
            if (response.ok) {
              alert(data.message);
              document.getElementById("resetPasswordForm").reset();
            } else {
              alert(data.message);
            }
          } catch (error) {
            alert("An error occurred. Please try again later.");
          }
        });
    </script>
  </body>
</html>